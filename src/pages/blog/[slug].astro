---
import "../../styles/global.css";
import { getCollection, getEntry } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((entry) => ({
    params: { slug: entry.slug },
  }));
}

const slug = Astro.params.slug;
const entry = await getEntry("blog", slug);
if (!entry) {
  return Astro.redirect("/blog/");
}
const { Content } = await entry.render();
const { data } = entry;

const canonical = Astro.site
  ? new URL(`/blog/${entry.slug}/`, Astro.site).href
  : `https://greenlightapprovals.io/blog/${entry.slug}/`;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{data.title} | Blog | Greenlight Approvals</title>
    <meta name="description" content={data.description} />
    <link rel="canonical" href={canonical} />
    <link rel="icon" href="/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="site-header" id="top">
      <nav class="nav">
        <a href="/" class="brand">
          <svg class="logo-mark" viewBox="0 0 120 120" role="img" aria-label="Greenlight Approvals logo">
            <defs>
              <linearGradient id="logoGradientBlogPost" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#6C63FF" />
                <stop offset="100%" stop-color="#0FB59B" />
              </linearGradient>
            </defs>
            <circle cx="60" cy="60" r="54" fill="url(#logoGradientBlogPost)" />
            <path
              d="M44 61.5L58.2 75.7 82 48.5"
              fill="none"
              stroke="#FFFFFF"
              stroke-width="12"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          <span>Greenlight Approvals</span>
        </a>
        <div class="nav-links">
          <a href="/#features">Product</a>
          <a href="/#pricing">Pricing</a>
          <a href="/#contact">Contact</a>
        </div>
        <a class="cta ghost" href="/#contact">Book a Demo</a>
      </nav>
    </header>
    <main class="blog-post-main">
      <a href="/blog/" class="blog-back">← Back to blog</a>

      <article class="blog-post">
        <header class="blog-post__header">
          <time class="blog-post__date" datetime={data.pubDate.toISOString()}>
            {data.pubDate.toLocaleDateString("en-US", { year: "numeric", month: "long", day: "numeric" })}
          </time>
          <h1 class="blog-post__title">{data.title}</h1>
          {data.tags.length > 0 && (
            <ul class="blog-post__tags" aria-label="Tags">
              {data.tags.map((tag) => (
                <li><span class="blog-tag">{tag}</span></li>
              ))}
            </ul>
          )}
        </header>
        <div class="blog-post__content">
          <Content />
        </div>
      </article>
    </main>

    <footer class="footer">
      <div>
        <svg class="logo-mark" viewBox="0 0 120 120" role="img" aria-label="Greenlight Approvals logo">
          <defs>
            <linearGradient id="logoGradientFooterBlogPost" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#6C63FF" />
              <stop offset="100%" stop-color="#0FB59B" />
            </linearGradient>
          </defs>
          <circle cx="60" cy="60" r="54" fill="url(#logoGradientFooterBlogPost)" />
          <path
            d="M44 61.5L58.2 75.7 82 48.5"
            fill="none"
            stroke="#FFFFFF"
            stroke-width="12"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        <p>© {new Date().getFullYear()} Greenlight Software LLC • Wyoming</p>
      </div>
      <div class="footer-links">
        <a href="/privacy">Privacy</a>
        <a href="/terms">Terms</a>
        <a href="#top">Back to top</a>
      </div>
    </footer>
  </body>
</html>

<style>
  .blog-post-main {
    width: min(680px, calc(100% - 2.5rem));
    margin: 0 auto 4rem;
    padding-top: 2rem;
  }

  .blog-back {
    display: inline-block;
    margin-bottom: 2rem;
    color: var(--muted);
    font-size: 0.95rem;
  }

  .blog-back:hover {
    color: var(--accent);
  }

  .blog-post__header {
    margin-bottom: 2rem;
  }

  .blog-post__date {
    display: block;
    font-size: 0.9rem;
    color: var(--muted);
    margin-bottom: 0.5rem;
  }

  .blog-post__title {
    font-size: clamp(1.75rem, 3vw, 2.25rem);
    line-height: 1.3;
    margin-bottom: 1rem;
  }

  .blog-post__tags {
    list-style: none;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .blog-post__tags .blog-tag {
    display: inline-block;
    padding: 0.2rem 0.6rem;
    border-radius: 999px;
    font-size: 0.8rem;
    background: rgba(16, 185, 129, 0.15);
    color: var(--accent);
  }

  .blog-post__content {
    font-size: 1.05rem;
    line-height: 1.7;
  }

  .blog-post__content :global(h2) {
    font-size: 1.35rem;
    margin: 2rem 0 0.75rem;
  }

  .blog-post__content :global(h3) {
    font-size: 1.15rem;
    margin: 1.5rem 0 0.5rem;
  }

  .blog-post__content :global(p) {
    margin-bottom: 1rem;
  }

  .blog-post__content :global(ul),
  .blog-post__content :global(ol) {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
  }

  .blog-post__content :global(li) {
    margin-bottom: 0.35rem;
  }

  .blog-post__content :global(strong) {
    font-weight: 600;
  }

  .blog-post__content :global(a) {
    color: var(--accent);
    text-decoration: underline;
  }

  .blog-post__content :global(a:hover) {
    text-decoration: none;
  }
</style>
